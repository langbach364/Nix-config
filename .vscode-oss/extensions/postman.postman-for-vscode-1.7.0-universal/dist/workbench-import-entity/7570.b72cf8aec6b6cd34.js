"use strict";(self.webpackChunkworkbench_import_entity=self.webpackChunkworkbench_import_entity||[]).push([[7570],{30869:(t,e,r)=>{r.d(e,{Z:()=>i});var a=r(56880),o=r(53186),s=r(10099),n=r(97504);const i=()=>{const t=(0,s.useActiveWorkspaceId)(),e=(0,o.useCreateNewCollection)(),r=(0,o.useWorkspacePermissions)(t);return async(o,s)=>{if(!r.userCanCreate)return{status:"error",description:"You do not have permission to import a collection."};const i=await(0,n.z)(s,o.name,"collection");if("cancel"===i)return{status:"error",description:"Import cancelled"};o.name=i;try{return await e.mutateAsync({workspaceId:t,requestBody:o}),a.AnalyticsService.addEventV2({category:"http-collection",action:"create",label:"import",value:1}),{status:"success",description:"Collection imported successfully."}}catch(t){return t.name.includes("TimeoutError")?{status:"error",description:"Import request timed out. Please wait for some time or try again."}:{status:"error",description:"Could not import collection. Please try again."}}}}},14162:(t,e,r)=>{r.d(e,{Z:()=>c});var a=r(98276),o=r(56880),s=r(10099),n=r(97201),i=r(97504);const c=()=>{const t=(0,s.useActiveWorkspaceId)(),e=(0,a.useCreateNewEnvironment)(),{data:r}=(0,n.useDataFetch)((0,a.getEnvironmentSidebarPermissionsQuery)(t));return async(a,s)=>{if(null==r||!r.userCanCreateEnvironment)return{status:"error",description:"You do not have permission to import an environment."};if(s){const t=await(0,i.z)(s,a.name,"environment");if("cancel"===t)return{status:"error",description:"Import cancelled"};a.name=t}try{const r=await e.mutateAsync({workspaceId:t,requestBody:a});return o.AnalyticsService.addEventV2({category:"environment",action:"create",label:"import"}),{status:"success",description:"Environment imported successfully.",data:r.data}}catch(t){return t.name.includes("TimeoutError")?{status:"error",description:"Import request timed out. Please wait for some time or try again."}:{status:"error",description:"Could not import environment. Please try again."}}}}},97504:(t,e,r)=>{r.d(e,{z:()=>s});var a=r(26246),o=r(98276);const s=async(t,e,r)=>{let s=!1;const n=t?t.map((t=>(t.name===e&&(s=!0),t.name))):[];if(s){const t=a.Modals.getModals(),s=await t.showWarningDialog({uid:`${r}-import-duplicate-warning`,subject:"",message:`${"collection"===r?"A collection":"An environment"} ${e} already exists. What would you like to do?`,options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Import as Copy",isPrimary:!0}]});return s&&"Import as Copy"===s.title?(0,o.getDuplicateEntityName)(n,e):"cancel"}return e}},8123:(t,e,r)=>{r.d(e,{Y:()=>i,n:()=>n});var a=r(21466),o=r(51759),s=r(13101);const n=async t=>{{const e=await a.VSCodeCommunicationsService.postMessageToExtensionAsPromise({type:"IMPORT_FILE",payload:{fileDetails:t,userId:(0,s.getUserId)()}});if(e.err)throw new Error(e.val.message);return e.val}},i=async t=>{await a.VSCodeCommunicationsService.postMessageToExtensionAsPromise({type:"DOT_ENV_METADATA_QUERY",payload:{action:o.ImportMessages.DotEnvMetadataQuery.storeEnvMetaData,data:t}})}},77570:(t,e,r)=>{r.r(e),r.d(e,{MultiFileImport:()=>T,default:()=>D});var a=r(7560),o=r(40540),s=r(58560),n=r(43652),i=r(23468),c=r(80605),l=r(35736),d=r(81397),u=r(74962),m=r(35482),p=r(38394),y=r(32054),g=r(59530),f=r.n(g),v=r(91246),h=r(53186),w=r(98276),C=r(10099),I=r(30869),x=r(14162),k=r(39245),b=r(8123),E=r(52322);const _=f()(s.Z).withConfig({displayName:"multi-file-import__ImportListContainer",componentId:"sc-km7lao-0"})(["padding-left:var(--spacing-l);padding-right:var(--spacing-l);flex-direction:column;"]),S=f()(n.Z).withConfig({displayName:"multi-file-import__SearchContainer",componentId:"sc-km7lao-1"})(["margin:var(--spacing-l) 0;"]),N=f()(i.Z).withConfig({displayName:"multi-file-import__StyledTable",componentId:"sc-km7lao-2"})(["padding-left:var(--spacing-xl);padding-right:var(--spacing-xl);"]),Z=f()(s.Z).withConfig({displayName:"multi-file-import__Footer",componentId:"sc-km7lao-3"})(["margin-right:var(--spacing-xl);margin-top:var(--spacing-xl);"]),j=f()(c.Z).withConfig({displayName:"multi-file-import__StyledButton",componentId:"sc-km7lao-4"})([":disabled{background-color:var(--button-primary-background-color) !important;color:var(--button-primary-content-color) !important;opacity:0.5;}"]),A=f()(s.Z).withConfig({displayName:"multi-file-import__HeaderSection",componentId:"sc-km7lao-5"})(["padding:var(--spacing-m) var(--spacing-l);border-bottom:var(--border-color-default) var(--border-width-default) solid;"]),T=()=>{var t;const e=(0,v.Z)(),[r,s]=(0,o.useState)(""),{setTabTitle:n}=(0,k.useTabTitleMeta)();(0,o.useEffect)((()=>{n("Import","import")}),[n]);const[i,g]=(0,o.useState)(null!=(t=e.data)?t:[]),[f,T]=(0,o.useState)((0,a.Z)({},i.map((()=>!0)))),[D,M]=(0,o.useState)(!1),O=(0,C.useActiveWorkspaceId)(),{data:P}=(0,h.useCollectionList)({workspaceId:O}),{data:W}=(0,w.useEnvironmentItems)({workspaceId:O}),L=(0,I.Z)(),F=(0,x.Z)(),V=D?[{id:"status",accessor:"status",cellWidth:"2%",Cell:({value:t})=>{if(t){if(t.isLoading)return(0,E.jsx)(l.Z,{});if(t.error)return(0,E.jsx)(d.Z,{content:t.error,children:(0,E.jsx)(m.Z,{"data-testid":"import-status-icon",color:"content-color-error"})});if(t.success)return(0,E.jsx)(d.Z,{content:"Imported successfully",children:(0,E.jsx)(p.Z,{"data-testid":"import-status-icon",color:"content-color-success"})})}return null}},{Header:"Name",accessor:"name",cellWidth:"40%"},{Header:"Import As",accessor:"format",cellWidth:"40%"},{id:"action",accessor:"status",cellWidth:"5%",Cell:t=>{const e=t.row.original;return e.status&&e.status.error?(0,E.jsx)(c.Z,{onClick:()=>q(e),type:"plain",text:"Retry"}):null}}]:[{Header:"Name",accessor:"name"},{Header:"Import As",accessor:"format"}],H=(t,e)=>{const r=[...i],a=r.find((e=>e.path===t));a&&(a.status=e),g(r)},q=async t=>{let e={isLoading:!0};H(t.path,e);try{const r=await(0,b.n)(t),a="postman_collection"===r.type?await L(r.data,null!=P?P:[]):await F(r.data,null!=W?W:[]);"error"===a.status&&(e={isLoading:!1,error:a.description}),"success"===a.status&&(e={isLoading:!1,success:!0})}catch(t){e={isLoading:!1,error:t.message}}finally{H(t.path,e)}};return(0,o.useEffect)((()=>{if(D)for(const t of i)q(t)}),[D]),(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(A,{children:(0,E.jsx)(u.Z,{type:"h4",text:`Import Elements (${i.length})`})}),(0,E.jsxs)(_,{"data-testid":"import-list-container",children:[(0,E.jsx)(S,{type:"search",value:r,onClear:()=>s(""),onChange:t=>{s(t.target.value)},placeholder:"Search for a file",width:"40%",prefix:(0,E.jsx)(y.Z,{})}),(0,E.jsx)(N,{data:i,columns:V,globalFilter:{filter:r},rowSelected:D?{}:{onSelect:t=>T(t),initialSelectionState:f}}),(0,E.jsx)(Z,{justifyContent:"flex-end",children:D?(0,E.jsx)(E.Fragment,{}):(0,E.jsx)(j,{onClick:async()=>{const t=[];for(const e of Object.keys(f))t.push(i[Number(e)]);g(t),M(!0)},type:"primary",text:"Import","data-testid":"import-btn",isDisabled:0===Object.keys(f).length})})]})]})},D=T},91246:(t,e,r)=>{r.d(e,{Z:()=>o});var a=r(32234);const o=()=>{if(window.NAVIGATION_CONTEXT){const e=JSON.parse(window.NAVIGATION_CONTEXT);try{var t;return JSON.parse(a.Base64.decode(null==e||null==(t=e.options)?void 0:t.importData))}catch(t){return{}}}return{}}}}]);
//# sourceMappingURL=7570.b72cf8aec6b6cd34.js.map