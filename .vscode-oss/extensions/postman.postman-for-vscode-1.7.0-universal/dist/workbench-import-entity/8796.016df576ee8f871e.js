"use strict";(self.webpackChunkworkbench_import_entity=self.webpackChunkworkbench_import_entity||[]).push([[8796],{38796:(t,e,r)=>{r.r(e);var o=r(40540),a=r(21730),n=r(60607),s=r(21180),i=r(39245),c=r(7560),l=r(58560),d=r(43652),p=r(23468),u=r(80605),m=r(35736),h=r(81397),f=r(74962),g=r(35482),y=r(38394),v=r(32054),w=r(59530),x=r.n(w),k=r(91246),b=r(53186),I=r(98276),j=r(10099),C=r(56880),Z=r(97504);var S=r(14162),E=r(8123),_=r(52322);const N=x()(l.Z).withConfig({displayName:"multi-file-import__ImportListContainer",componentId:"sc-km7lao-0"})(["padding-left:var(--spacing-l);padding-right:var(--spacing-l);flex-direction:column;"]),T=x()(d.Z).withConfig({displayName:"multi-file-import__SearchContainer",componentId:"sc-km7lao-1"})(["margin:var(--spacing-l) 0;"]),R=x()(p.Z).withConfig({displayName:"multi-file-import__StyledTable",componentId:"sc-km7lao-2"})(["padding-left:var(--spacing-xl);padding-right:var(--spacing-xl);"]),W=x()(l.Z).withConfig({displayName:"multi-file-import__Footer",componentId:"sc-km7lao-3"})(["margin-right:var(--spacing-xl);margin-top:var(--spacing-xl);"]),L=x()(u.Z).withConfig({displayName:"multi-file-import__StyledButton",componentId:"sc-km7lao-4"})([":disabled{background-color:var(--button-primary-background-color) !important;color:var(--button-primary-content-color) !important;opacity:0.5;}"]),A=x()(l.Z).withConfig({displayName:"multi-file-import__HeaderSection",componentId:"sc-km7lao-5"})(["padding:var(--spacing-m) var(--spacing-l);border-bottom:var(--border-color-default) var(--border-width-default) solid;"]),B=()=>{var t;const e=(0,k.Z)(),[r,a]=(0,o.useState)(""),{setTabTitle:n}=(0,i.useTabTitleMeta)();(0,o.useEffect)((()=>{n("Import","import")}),[n]);const[s,l]=(0,o.useState)(null!=(t=e.data)?t:[]),[d,p]=(0,o.useState)((0,c.Z)({},s.map((()=>!0)))),[w,x]=(0,o.useState)(!1),B=(0,j.useActiveWorkspaceId)(),{data:P}=(0,b.useCollectionList)({workspaceId:B}),{data:H}=(0,I.useEnvironmentItems)({workspaceId:B}),D=(()=>{const t=(0,j.useActiveWorkspaceId)(),e=(0,b.useCreateNewCollection)(),r=(0,b.useWorkspacePermissions)(t);return async(o,a)=>{if(!r.userCanCreate)return{status:"error",description:"You do not have permission to import a collection."};const n=await(0,Z.z)(a,o.name,"collection");if("cancel"===n)return{status:"error",description:"Import cancelled"};o.name=n;try{return await e.mutateAsync({workspaceId:t,requestBody:o}),C.AnalyticsService.addEventV2({category:"http-collection",action:"create",label:"import",value:1}),{status:"success",description:"Collection imported successfully."}}catch(t){return t.name.includes("TimeoutError")?{status:"error",description:"Import request timed out. Please wait for some time or try again."}:{status:"error",description:"Could not import collection. Please try again."}}}})(),F=(0,S.Z)(),q=w?[{id:"status",accessor:"status",cellWidth:"2%",Cell:({value:t})=>{if(t){if(t.isLoading)return(0,_.jsx)(m.Z,{});if(t.error)return(0,_.jsx)(h.Z,{content:t.error,children:(0,_.jsx)(g.Z,{"data-testid":"import-status-icon",color:"content-color-error"})});if(t.success)return(0,_.jsx)(h.Z,{content:"Imported successfully",children:(0,_.jsx)(y.Z,{"data-testid":"import-status-icon",color:"content-color-success"})})}return null}},{Header:"Name",accessor:"name",cellWidth:"40%"},{Header:"Import As",accessor:"format",cellWidth:"40%"},{id:"action",accessor:"status",cellWidth:"5%",Cell:t=>{const e=t.row.original;return e.status&&e.status.error?(0,_.jsx)(u.Z,{onClick:()=>O(e),type:"plain",text:"Retry"}):null}}]:[{Header:"Name",accessor:"name"},{Header:"Import As",accessor:"format"}],M=(t,e)=>{const r=[...s],o=r.find((e=>e.path===t));o&&(o.status=e),l(r)},O=async t=>{let e={isLoading:!0};M(t.path,e);try{const r=await(0,E.n)(t),o="postman_collection"===r.type?await D(r.data,null!=P?P:[]):await F(r.data,null!=H?H:[]);"error"===o.status&&(e={isLoading:!1,error:o.description}),"success"===o.status&&(e={isLoading:!1,success:!0})}catch(t){e={isLoading:!1,error:t.message}}finally{M(t.path,e)}};return(0,o.useEffect)((()=>{if(w)for(const t of s)O(t)}),[w]),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(A,{children:(0,_.jsx)(f.Z,{type:"h4",text:`Import Elements (${s.length})`})}),(0,_.jsxs)(N,{"data-testid":"import-list-container",children:[(0,_.jsx)(T,{type:"search",value:r,onClear:()=>a(""),onChange:t=>{a(t.target.value)},placeholder:"Search for a file",width:"40%",prefix:(0,_.jsx)(v.Z,{})}),(0,_.jsx)(R,{data:s,columns:q,globalFilter:{filter:r},rowSelected:w?{}:{onSelect:t=>p(t),initialSelectionState:d}}),(0,_.jsx)(W,{justifyContent:"flex-end",children:w?(0,_.jsx)(_.Fragment,{}):(0,_.jsx)(L,{onClick:async()=>{const t=[];for(const e of Object.keys(d))t.push(s[Number(e)]);l(t),x(!0)},type:"primary",text:"Import","data-testid":"import-btn",isDisabled:0===Object.keys(d).length})})]})]})};var P=r(65482),H=r(47410),D=r(85646);const F=()=>{const t=(0,k.Z)(),{setTabTitle:e}=(0,i.useTabTitleMeta)();(0,o.useEffect)((()=>{e("Import","import")}),[e]);const[r,a]=(0,o.useState)((0,H.QR)(null!=t?t:[])),[n,s]=(0,o.useState)(""),[l,d]=(0,o.useState)((0,c.Z)({},r.map((()=>!0)))),p=()=>{s("")},u=()=>{a((0,H.QR)(null!=t?t:[]))},m=(t,e)=>{const o=r.map((r=>r.path===n?(0,c.Z)({},r,{[t]:e}):r));a(o)};if(n){const t=r.find((t=>t.path===n));return(0,_.jsx)(D.Z,{envData:t,handleBack:p,handleChange:m,handleReset:u})}return(0,_.jsx)(P.Z,{envData:r,setEnvData:a,setSelectedEnvironment:s,rowsSelected:l,setRowsSelected:d,detectedEnvCount:t.length,envCountWithNoVariables:(0,H.Ef)(t)})},q=[{path:"/workspace/:workspaceId/import/:importId",element:(0,_.jsx)(B,{}),errorElement:(0,_.jsx)(s.RouteErrorBoundary,{appId:"workbench-import-entity",errorElementId:"workbench-import-entity-route"})},{path:"/workspace/:workspaceId/import/dotenv",element:(0,_.jsx)(F,{}),errorElement:(0,_.jsx)(s.RouteErrorBoundary,{appId:"workbench-import-entity",errorElementId:"multi-dot-env-import-route"})}],{router:M}=(0,i.createPlatformRouter)(q);function O(){return(0,_.jsx)(n.RouterProvider,{router:M})}var Q=r(28422);const V=document.querySelector("#workbench-import-entity_root");a.render((0,_.jsx)(Q.PostmanBootstrap,{appId:"workbench-import-entity",errorElementId:"global-error-boundary",children:(0,_.jsx)(O,{})}),V)}}]);
//# sourceMappingURL=8796.016df576ee8f871e.js.map