"use strict";(self.webpackChunkhttp_response_workbench=self.webpackChunkhttp_response_workbench||[]).push([[1134],{71134:(e,n,i)=>{i.r(n),i.d(n,{FileUploader:()=>fe,KeyValueEditor:()=>Rn});var l=i(40540),t=i(59530),o=i.n(t),a=i(78476),s=i(50297),r=i(98283),d=i(49284),c=i(69356),u=i.n(c),p=i(22833),h=i.n(p),b=i(65848),g=i(52322);const v=o().div.withConfig({displayName:"key-value-row-actions__KeyValueRowActionsContainer",componentId:"sc-giwhs-0"})(["position:relative;display:flex;width:40px;justify-content:flex-end;align-items:center;padding-right:4px;border-left:var(--border-width-default) var(--border-style-solid) var(--border-color-default);border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);background-color:",";"],(e=>e.disabled?"var(--background-color-secondary);":"inherit")),f=o()(b.Z).withConfig({displayName:"key-value-row-actions__StyledCheckbox",componentId:"sc-giwhs-1"})(["> span > div{height:16px;width:16px;background-color:",";}&.disabled{opacity:0.4;}"],(e=>e.isChecked?"dark"===e.theme.name?"#ffffff":"#262626":"inherit"));function m(e){return(0,g.jsx)(v,{disabled:e.disabled,children:e.shouldShowCheckbox&&(0,g.jsx)(f,{className:h()({disabled:e.isCheckboxDisabled}),isChecked:e.isRowEnabled,onChange:e.onToggleEnabledState,isDisabled:e.isCheckboxDisabled})})}const y=["content"],x=o().div.withConfig({displayName:"key-value-column__KeyValueColumnContainer",componentId:"sc-shzowe-0"})(["display:flex;flex:",";overflow-y:visible;min-width:0;margin:var(--spacing-zero);position:relative;height:32px;box-sizing:border-box;border-right:",";background-color:",";.key-value-cell{color:",";}"],(e=>e.isLastColumn?`0 1 ${e.columnWidth}%`:`0 0 ${e.columnWidth}%`),(({isLastColumn:e})=>e?"unset":"var(--border-width-default) var(--border-style-solid)\n    var(--border-color-default)"),(e=>e.isNonEditable?"var(--background-color-secondary)":"inherit"),(e=>e.isNonEditable?"var(--content-color-secondary)":"inherit"));function w(e){let{content:n}=e,i=(0,r.Z)(e,y);return(0,g.jsx)(x,Object.assign({},i,{children:n}))}const C=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"";function k(e,n){if(typeof e!=typeof n)return!1;const i=typeof e;return["string","number","boolean","undefined"].includes(typeof e)?e===n:Array.isArray(e)&&Array.isArray(n)?e.length===n.length&&e.every(((e,i)=>k(e,n[i]))):"object"===i&&(null===e&&null===n||null!==e&&null!==n&&!Array.isArray(e)&&!Array.isArray(n)&&Object.keys(e).length===Object.keys(n).length&&Object.keys(e).every((i=>k(e[i],n[i]))))}var j=i(59713);const V=o().div.withConfig({displayName:"delete-row__IconContainer",componentId:"sc-1t4lde4-0"})(["align-items:center;height:24px;display:inline-flex;padding:0 var(--spacing-s);border-radius:var(--border-radius-default);&:hover{background-color:var(--highlight-background-color-primary);cursor:pointer;}"]);function S({onClick:e}){return(0,g.jsx)(V,{className:"delete-button",onClick:e,role:"button","aria-label":"delete-row",children:(0,g.jsx)(j.Z,{})})}function T(e,n,i){let l,t,o,a,s,r,d=0,c=!1,u=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");if(n=+n||0,i&&function(e){const n=typeof e;return null!=e&&("object"===n||"function"===n)}(i)){if(c=!(null==i||!i.leading),u="maxWait"in i,u){const e=(null==i?void 0:i.maxWait)||0;o=Math.max(+e,n)}p="trailing"in i?!(null==i||!i.trailing):p}function h(n){const i=l,o=t;return l=t=void 0,d=n,a=e.apply(o,i),a}function b(e,n){return setTimeout(e,n)}function g(e){const i=e-r;return void 0===r||i>=n||i<0||u&&e-d>=o}function v(){const e=Date.now();if(g(e))return f(e);s=b(v,function(e){const i=e-d,l=n-(e-r);return u?Math.min(l,o-i):l}(e))}function f(e){return s=void 0,p&&l?h(e):(l=t=void 0,a)}function m(...e){const i=Date.now(),o=g(i);if(l=e,t=this,r=i,o){if(void 0===s)return function(e){return d=e,s=b(v,n),c?h(e):a}(r);if(u)return s=b(v,n),h(r)}return void 0===s&&(s=b(v,n)),a}return m.cancel=function(){void 0!==s&&clearTimeout(s),d=0,l=r=t=s=void 0},m.flush=function(){return void 0===s?a:f(Date.now())},m.pending=function(){return void 0!==s},m}const E=["indicators","isDuplicated"],_=o().textarea.withConfig({displayName:"editable-cell__StyledTextArea",componentId:"sc-1v6ab2g-0"})(["width:100%;color:var(--content-color-primary);font-size:inherit;font-family:inherit;outline:transparent;resize:none;font-weight:inherit;background:var(--background-color-primary);margin:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-zero) var(--spacing-xs) var(--spacing-xs);border:var(--border-width-default) var(--border-style-solid) var(--border-color-default);z-index:1;",""],(({isDuplicated:e})=>e&&"padding-right: var(--spacing-l)")),D=o().div.withConfig({displayName:"editable-cell__StyledWrapper",componentId:"sc-1v6ab2g-1"})(["display:flex;align-items:flex-start;max-height:var(--size-m);height:100%;width:100%;"]),O=T(((e,n,i)=>{var l,t;const o=null!=(l=(null==e?void 0:e.scrollHeight)/(null==e||null==(t=e.parentNode)?void 0:t.clientHeight))?l:0;o!==n&&i(Math.ceil(o))}),100);function R(e){let{indicators:n,isDuplicated:i}=e,t=(0,r.Z)(e,E);const o=(0,l.useRef)(null),[a,s]=(0,l.useState)(1);return(0,l.useEffect)((()=>(setTimeout((()=>{if(o.current){const e=o.current.value.length;o.current.selectionStart=e,o.current.selectionEnd=e,o.current.scrollTop=o.current.scrollHeight}})),O(o.current,a,s),()=>{O.cancel()})),[a]),(0,g.jsxs)(D,{children:[(0,g.jsx)(_,{isDuplicated:i,role:"cell","aria-label":`${t.type} input`,ref:o,value:t.value,rows:a,onChange:e=>{t.onChange(e.target.value),O(o.current,a,s)},autoFocus:t.shouldFocusOnMount,placeholder:t.placeholder||"",readOnly:t.readOnly,onBlur:t.onBlur,onKeyDown:e=>{t.preventEnter&&13===e.keyCode&&e.preventDefault()}}),n]})}function A(e){return"string"==typeof e?e:e?e&&e.toString?String(e):Object.prototype.toString.call(e):""}function N(e,n={}){return e?("string"!=typeof e&&(e=A(e)),e.split("\n").map(((e,i)=>(0,g.jsx)("span",{children:W(e,n)},i)))):e}function F(e,n={}){return e?("string"!=typeof e&&(e=A(e)),W(e.split("\n")[0],n)):e}function W(e,n={}){const i=n.maxLength||100;return e?("string"!=typeof e&&(e=A(e)),e.length<=i?e:e.slice(0,i+1)):""}const M=o().div.withConfig({displayName:"key-value-cell__KeyValueCellContainer",componentId:"sc-1i3qzo1-0"})(["width:100%;padding:var(--spacing-zero) var(--spacing-xs) var(--spacing-zero) 9px;align-items:center;cursor:text;font-size:var(--text-size-m);user-select:none;display:flex;height:100%;box-sizing:border-box;justify-content:space-between;color:var(--content-color-primary);",""],(({isDuplicated:e})=>e&&"padding-right: var(--spacing-xl)")),P=o().div.withConfig({displayName:"key-value-cell__KeyValueCellTextContainer",componentId:"sc-1i3qzo1-1"})(["white-space:pre;overflow:hidden;text-overflow:ellipsis;&:empty:not(:focus)::before{content:attr(data-placeholder);color:var(--content-color-tertiary);}"]);function I(e){const n=(0,l.useRef)(null),{value:i,placeholder:t,onBlur:o,preventEnter:a,onFocus:s,type:r,currentWidth:d,actions:c,indicators:u,isDuplicated:p}=e,h=!a,b=(0,l.useCallback)((()=>{null==s||s()}),[s]),v=!i&&t,f=v?`${r} empty cell`:`${r} cell`;return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(M,{onBlur:o,onClick:b,ref:n,tabIndex:"0",onFocus:b,isDuplicated:p,children:(0,g.jsx)(P,{role:"cell","aria-label":f,"data-placeholder":v?t:null,children:h?F(i,{maxLength:Math.ceil(2*d)}):N(i,{maxLength:Math.ceil(2*d)})})}),u,c]})}M.displayName="KeyValueCellContainer";const z=[{value:"text",label:"Text"},{value:"file",label:"File"}],Z="secret",H="default",B=o().div.withConfig({displayName:"masked-cell__MaskedInputContainer",componentId:"sc-1fwx2vm-0"})(["padding-inline-start:var(--spacing-xs);display:flex;flex:1;input{border:var(--border-width-default) var(--border-style-solid) transparent;color:var(--content-color-primary);width:100%;font-size:var(--text-size-m);line-height:var(--line-height-m);font-family:var(--text-family-default);height:var(--controls-size-default);box-sizing:border-box;background-color:transparent;padding:var(--spacing-zero);overflow:hidden;text-overflow:ellipsis;display:block;padding-left:var(--spacing-xs);&:hover,&:focus,&:active{outline:none;}",";}"],(({isFocused:e})=>e&&"\n        border: var(--border-width-default) var(--border-style-solid) var(--border-color-default);\n        background: var(--background-color-primary);\n        height: var(--size-s);\n        padding-left: var(--spacing-xs);\n        margin-top: var(--spacing-xs);\n        margin-right: var(--spacing-s);\n    "));function K(e){const{value:n,isEditable:i,onBlur:l,onChange:t,onFocus:o,type:a}=e,s=`${a} masked cell`;return(0,g.jsx)(B,{isFocused:Boolean(i),onBlur:l,onClick:o,onFocus:o,children:(0,g.jsx)("input",{role:"cell","aria-label":s,value:n||"",spellCheck:!1,type:"password",onChange:e=>{t(e.currentTarget.value)}},"text")})}var L=i(16913),$=i(81397),q=i(88131);const U=["hidden","value","isEditable","currentWidth","readOnly","shouldFocusOnMount","onBlur","onChange","onFocus","actions","editorType","maskState","enableVariableSuggestions","placeholder","isDuplicated"],X=o()(L.Z).withConfig({displayName:"key-value-cell-editor__StyledWarningIcon",componentId:"sc-c7rjy0-0"})(["position:absolute;align-self:center;right:var(--spacing-s);z-index:10;"]);function Y(e){const{hidden:n,value:i,isEditable:l,currentWidth:t,readOnly:o,shouldFocusOnMount:a,onBlur:s,onChange:d,onFocus:c,actions:u,editorType:p,maskState:h,enableVariableSuggestions:b,placeholder:v,isDuplicated:f}=e,m=(0,r.Z)(e,U),y={readOnly:o,shouldFocusOnMount:a,onBlur:s,onChange:d},x=e=>{null==d||d(m.type,e)},w=(0,q.usePostmanInputFeatureFlag)();if(n)return null;if(b&&w){let n=!i&&v?`${m.type} empty cell`:`${m.type} cell`;return l&&(n=`${m.type} input`),(0,g.jsx)(q.KVEditorInput,{value:i||"",onChange:x,suggestions:[],placeholder:"key"===m.type?"Key":"Value",ariaLabel:n,onFocus:c,onBlur:s,shouldFocusOnMount:a,actions:u,indicators:e.indicators,isEditable:!y.readOnly})}return p===Z&&h.isMasked?(0,g.jsx)(K,Object.assign({onChange:x,onFocus:c,onBlur:s,isEditable:l,value:i,placeholder:v},m)):(0,g.jsxs)(g.Fragment,{children:[l?(0,g.jsx)(R,Object.assign({},y,{onChange:x,onFocus:c,value:i,placeholder:v,isDuplicated:f},m)):(0,g.jsx)(I,Object.assign({},m,{value:i,onFocus:c,actions:u,onChange:x,placeholder:v,currentWidth:t,isDuplicated:f})),f&&(0,g.jsx)($.Z,{content:"This variable has been overwritten by a duplicate key.",placement:"bottom",children:(0,g.jsx)(X,{color:"content-color-warning",className:"duplicate-warning-icon"})})]})}var G=i(74962),J=i(63622),Q=i(84591);const ee=o().div.withConfig({displayName:"key-value-cell-info__InfoIconContainer",componentId:"sc-3nzppj-0"})(["position:absolute;right:var(--spacing-m);display:flex;height:100%;align-items:center;cursor:default;z-index:1;background:transparent !important;"]),ne=({infoTitle:e,info:n})=>(0,g.jsxs)(g.Fragment,{children:[e&&(0,g.jsx)(G.Z,{type:"h3",styleAs:"h4",text:e}),n&&(0,g.jsx)(J.ZP,{type:"small",color:"content-color-primary",children:n})]}),ie=e=>{const{info:n,infoTitle:i,placement:l}=e;return n||i?(0,g.jsx)(ee,{children:(0,g.jsx)($.Z,{content:(0,g.jsx)(ne,Object.assign({},e)),placement:l,children:(0,g.jsx)(Q.Z,{})})}):null},le=o()(d.Z).withConfig({displayName:"key-value-dropdown__StyledSelect",componentId:"sc-1ccix0v-0"})(["margin:var(--spacing-xs);min-width:80px;"]);function te(e){const{hidden:n,options:i,defaultOption:t,onChange:o}=e,[a,s]=(0,l.useState)(t),[r,d]=(0,l.useState)(!1);return!r&&n?null:(0,g.jsx)(le,{viaPortal:!0,className:"single-type-select","aria-label":"KV Type Select",triggerWidth:"auto",triggerSize:"small",triggerType:"tertiary",menuMinWidth:100,menuMaxWidth:165,isSearchable:!1,isClearable:!1,options:i,value:a,onOpen:()=>d(!0),onClose:()=>d(!1),onChange:e=>{s(e),null==o||o(e)}})}var oe=i(58560),ae=i(25637),se=i(5701),re=i(35736),de=i(21466);function ce(e){const n=e.split(/[/\\]/).pop()||"",i=n.split(".").pop()||"";return{name:n,extension:i}}const ue=["value","onReset","id","label","name","multiple","isDisabled","loading","error","accept","autoFocus","onChange"],pe="Couldn't upload file",he=o().input.attrs({type:"file"}).withConfig({displayName:"file-uploader__StyledInputFile",componentId:"sc-cfed37-0"})(["opacity:0;height:0;width:0;z-index:-1;&:focus + label{box-shadow:var(--shadow-focus);outline:none;}"]),be=o().label.withConfig({displayName:"file-uploader__StyledFileUploaderLabel",componentId:"sc-cfed37-1"})(["display:flex;gap:var(--spacing-s);user-select:none;color:",";font-size:var(--text-size-m);width:max-content;height:var(--size-s);line-height:1.8;vertical-align:middle;padding:var(--spacing-zero) var(--spacing-m);border:var(--button-outline-border);border-color:var(--button-outline-border-color);box-sizing:border-box;border-radius:var(--border-radius-default);&:hover{cursor:",";",";}"],(e=>e.isDisabled?"var(--content-color-tertiary)":"var(--content-color-primary)"),(e=>e.isDisabled?"not-allowed":"pointer"),(e=>!e.isDisabled&&"border-color: var(--button-outline-hover-border-color)")),ge=o()(oe.Z).withConfig({displayName:"file-uploader__FileUploaderContainer",componentId:"sc-cfed37-2"})(["max-width:100%;"]),ve=o().div.withConfig({displayName:"file-uploader__StyledChip",componentId:"sc-cfed37-3"})(["width:100%;span{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;}"]);function fe(e){return(0,g.jsx)(ae.VW,{children:(0,g.jsx)(me,Object.assign({},e))})}function me(e){const{value:n,onReset:i,id:t,label:o,name:a,multiple:s,isDisabled:d,loading:c,error:u,accept:p,autoFocus:h,onChange:b}=e,v=(0,r.Z)(e,ue),{addToast:f}=(0,ae.ZP)();let m;if((0,l.useEffect)((()=>{u&&f({status:"error",title:pe,description:u})}),[u,f]),null!=n&&n.length){const e=n.length,l=n[0],t=n.join(", "),o=e>1?`${e} files selected`:`${l}`;m=(0,g.jsx)($.Z,{content:t,children:(0,g.jsx)(ve,{children:(0,g.jsx)(se.Af,{label:o,onClick:i})})})}else m=(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(he,Object.assign({},v,{id:t,onChange:e=>{const n=e.target,i=n&&n.files;!d&&i&&(null==b||b(i))},multiple:s,disabled:d,accept:p,name:a,autoFocus:h,onClick:e=>{e.currentTarget.value="",(async e=>{e.preventDefault();const n=await(0,de.openVSCodeFilePicker)({title:a,canSelectMany:s,filters:{default:(null==p?void 0:p.split(","))||[]}});!d&&n&&(null==b||b(function(e){const n=new DataTransfer;for(const{path:i}of e){const{name:e}=ce(i),l=new File([e],e,{type:"file"});Object.defineProperty(l,"path",{value:i,enumerable:!0,writable:!0}),n.items.add(l)}return n.files}(n)))})(e)}})),(0,g.jsxs)(be,{htmlFor:t,isDisabled:d,children:[c&&(0,g.jsx)(re.Z,{size:"small"}),(0,g.jsx)("span",{children:o})]})]});return(0,g.jsx)(ge,{direction:"column",alignItems:"center",children:m})}const ye=()=>{const e=(0,l.useRef)(!0);return(0,l.useEffect)((()=>()=>{e.current=!1}),[]),e},xe="Select Files",we=o()(oe.Z).withConfig({displayName:"key-value-file-uploader__StyledContainer",componentId:"sc-12ibx3l-0"})(["padding:var(--spacing-xs);"]);function Ce(e){const{id:n,type:i,value:t,hidden:o,error:a,onFilesSelect:s,onChange:r}=e,[d,c]=(0,l.useState)(!1),u=ye(),p=(0,l.useMemo)((()=>Array.isArray(t)?t:t?[t]:[]),[t]);return o?null:(0,g.jsx)(we,{height:"100%",width:"100%",children:(0,g.jsx)(fe,{label:xe,id:"key-value-file-uploader",multiple:!0,error:a,value:p,loading:d,onChange:e=>{s&&(c(!0),s(n,e).finally((()=>{u.current&&c(!1)})))},onReset:()=>null==r?void 0:r(i,"")})})}const ke=e=>e.disableEdit,je=(e,n)=>n||e.system&&!e.allowedToToggle,Ve=(e,n)=>!e.disableEdit&&!(null!=n&&n.disableToggle)||e.system;var Se=i(95362),Te=i(70262);const Ee=o().div.withConfig({displayName:"toggle-mask-button__IconContainer",componentId:"sc-1bzaljx-0"})(["padding:var(--spacing-xs) var(--spacing-s);border-radius:var(--border-radius-default);opacity:",";&:hover{cursor:pointer;}"],(({alwaysPresent:e})=>e?"1":"0"));function _e({onClick:e,maskState:n,isVisible:i}){const l=!1===n.isMasked;return(0,g.jsx)(Ee,{role:"button",className:"toggle-mask","aria-label":"toggle-mask-row",onClick:e,alwaysPresent:l||i,children:n.isMasked?(0,g.jsx)(Se.Z,{}):(0,g.jsx)(Te.Z,{})})}var De=i(64691),Oe=i(48263),Re=i(80605),Ae=i(59824),Ne=i(17282),Fe=i(29225);const We=e=>{const{onPersist:n,onReset:i,disableVariablePersistAction:l,disablePersistActionTooltip:t,disableResetActionTooltip:o,disableVariableResetAction:a}=e,s=(e=!1,n)=>{if(e){let e;switch(n){case"persist":e=t;break;case"reset":e=o}return e||"You do not have permissions to perform this action."}return null};return(0,g.jsxs)(De.Z,{children:[(0,g.jsx)(Oe.Z,{children:(0,g.jsx)(Re.Z,{icon:(0,g.jsx)(Fe.Z,{size:"small"}),type:"tertiary",tooltip:"View more actions",size:"small","data-testid":"more-options-button"})}),(0,g.jsxs)(Ae.Z,{placement:"bottom-end",children:[(0,g.jsx)(Ne.Z,{onClick:n,isDisabled:l,tooltip:s(l,"persist"),children:"Persist"}),(0,g.jsx)(Ne.Z,{onClick:i,isDisabled:a,tooltip:s(a,"reset"),children:"Reset"})]})]})},Me=o().div.withConfig({displayName:"key-value-row-actions-right__StyledActionsContainer",componentId:"sc-acbvs-0"})(["display:flex;flex-direction:row;opacity:",";margin-right:var(--spacing-xs);"],(({isVisible:e})=>e?"1":"0")),Pe=({isHidden:e=!1,children:n,isVisible:i})=>e||!n?null:(0,g.jsx)(Me,{isVisible:i,children:n});var Ie=i(26246);const ze=["warning"],Ze=["prevValue","prevCurrentWidth"],He=["nextValue","nextCurrentWidth"],Be=o().div.withConfig({displayName:"key-value-form-row__KeyValueFormRowContainer",componentId:"sc-1ypxq1j-0"})(["display:flex;flex-direction:row;position:relative;flex:0;height:32px;border-bottom:var(--border-width-default) var(--border-style-solid) var(--border-color-default);background-color:",";color:",";"],(e=>e.isRowFocused?"var(--background-color-secondary) !important":e.isRowSelected||e.disabled?"var(--background-color-secondary)":"inherit"),(e=>e.disabled?"var(--content-color-tertiary)":"inherit")),Ke=o().div.withConfig({displayName:"key-value-form-row__KeyValueRowInput",componentId:"sc-1ypxq1j-1"})(["position:relative;display:flex;flex:1;min-width:0;flex-direction:row;color:",";"],(e=>e.isBlocked?"var(--content-color-tertiary)":"inherit")),Le=o().div.withConfig({displayName:"key-value-form-row__StyledRowActionsContainer",componentId:"sc-1ypxq1j-2"})(["display:flex;align-items:center;cursor:pointer;border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);"]),$e=o()(d.Z).withConfig({displayName:"key-value-form-row__StyledVariableTypeDropdown",componentId:"sc-1ypxq1j-3"})([".aether-dropdown__control,.aether-dropdown__control--is-focused:hover{border:none;width:100%;box-shadow:none;background-color:unset !important;}"]),qe=new Map;qe.set("default",{value:H,label:"default"}),qe.set("secret",{value:Z,label:"secret"});const Ue=[qe.get("default"),qe.get("secret")];function Xe(e){const{index:n,value:i,onChange:t,onRemove:o,currentWidth:a,showColumns:s,allowedColumns:d,enableFiles:c,onFilesSelect:u,maskState:p,toggleMaskValue:h,hideVariableTypeDropdown:b,onPersist:v,onReset:f,onBlur:y,enableVariableSuggestions:x,optionsDropdownValues:k,isDuplicated:j}=e,V=(0,l.useRef)(t);V.current=t;let{key:T,value:E,sessionValue:_="",options:D,type:O,enabled:R=!0,description:A="",fileUploadError:N}=i;const F=O===Z?Z:H,W=s.includes("variableType")?F:O||"text",[M,P]=(0,l.useState)(null),[I,B]=(0,l.useState)(null),K=null!==M,L=(0,l.useMemo)((()=>{var e;return null!=(e=z.find((e=>e.value===i.type)))?e:z[0]}),[i.type]),$=(0,l.useCallback)(((e,n)=>{"sessionValue"===e&&void 0!==n&&i.isSessionValueDeleted&&(null==V.current||V.current(Object.assign({},i,{[e]:n,isSessionValueDeleted:!1}))),null==V.current||V.current(Object.assign({},i,{[e]:n}))}),[i]),q=(0,l.useCallback)((e=>{(0,r.Z)(i,ze),$("enabled",e)}),[i,$]),U=(0,l.useCallback)((()=>{o&&o()}),[o]),X=(0,l.useCallback)((n=>e[`nonEditable${C(n)}s`]),[e]);function G(e){return Number(a[null==s?void 0:s.indexOf(e)])}return(0,g.jsxs)(Be,{role:"row","aria-rowindex":n,disabled:ke(i),isRowSelected:e.isRowSelected,isRowFocused:null!==M,onMouseEnter:()=>B(!0),onMouseLeave:()=>B(!1),children:[(0,g.jsx)(m,{disabled:e.disableSorting&&e.nonEditableToggles,shouldShowCheckbox:Ve(i,e),isRowEnabled:R,onToggleEnabledState:q,isCheckboxDisabled:je(i,e.nonEditableToggles)}),(0,g.jsxs)(Ke,{isBlocked:i.disableEdit,children:[(0,g.jsx)(w,{columnWidth:G("key"),isNonEditable:X("key"),isLastColumn:s&&"key"===s[s.length-1],content:(0,g.jsx)(Y,{type:"key",value:T,currentWidth:G("key"),onFocus:()=>P("key"),onChange:$,isEditable:"key"===M,placeholder:e.keyPlaceholder,preventEnter:e.disableMultilineKey||!1,readOnly:i.disableEdit||e.nonEditableKeys,shouldFocusOnMount:!0,onBlur:()=>P(null),isDuplicated:j,actions:(0,g.jsx)(te,{hidden:!I||!c,options:z,defaultOption:L,onChange:e=>$("type",e.value)}),indicators:(0,g.jsx)(ie,{infoTitle:i.infoTitle,info:i.info,placement:"right"}),enableVariableSuggestions:x})}),s.includes("variableType")&&(0,g.jsx)(w,{columnWidth:G("variableType"),isNonEditable:X("variableType"),isLastColumn:s&&"variableType"===s[s.length-1],content:(!b||e.nonEditableVariableTypes)&&(0,g.jsx)($e,{isRowFocused:K,tabIndex:-1,isDisabled:e.nonEditableVariableTypes,onChange:async i=>{const{disableAllVariablesSync:l=!1,disableSecretVariablesSync:t}=e;if(O===i.value)return;if(l||!t&&i.value===Z||t&&i.value===Z&&!E)return $("type",i.value),void(h&&h(n));const o=Ie.Modals.getModals(),a=await o.showWarningDialog({uid:"kv-editor-variable-type-change-confirmation",subject:`Change ${T}'s type to ${i.value}?`,message:"This will reveal the hidden values in plain text everywhere in the app for all team members",options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Change type",isPrimary:!0}]});return a&&"Change type"===a.title?($("type",i.value),void(h&&h(n))):void 0},options:Ue,value:qe.get(W),isClearable:!1,isSearchable:!1,menuWidth:100})}),s.includes("value")&&(0,g.jsx)(w,{columnWidth:G("value"),isNonEditable:X("value"),isLastColumn:s&&"value"===s[s.length-1],content:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(Y,{hidden:"file"===O,type:"value",value:E,currentWidth:G("value"),onFocus:()=>P("value"),onChange:$,isEditable:"value"===M,placeholder:e.valuePlaceholder,preventEnter:e.disableMultilineValue||!1,readOnly:i.disableEdit||e.nonEditableValues,shouldFocusOnMount:!0,onBlur:()=>("value",P(null),void(y&&y("value",i))),editorType:O,maskState:p,enableVariableSuggestions:x}),(0,g.jsx)(Ce,{hidden:"file"!==O,id:n,type:"value",value:E,error:N,onChange:$,onFilesSelect:u})]})}),s.includes("description")&&(0,g.jsx)(w,{columnWidth:G("description"),isNonEditable:X("description"),isLastColumn:s&&"description"===s[s.length-1],content:(0,g.jsx)(Y,{type:"description",value:A,onChange:$,placeholder:e.descriptionPlaceholder,isEditable:"description"===M,currentWidth:G("description"),onFocus:()=>P("description"),readOnly:i.disableEdit||e.nonEditableDescriptions,shouldFocusOnMount:!0,onBlur:()=>P(null)})}),s.includes("sessionValue")&&(0,g.jsx)(w,{columnWidth:G("sessionValue"),isNonEditable:X("sessionValue"),isLastColumn:s&&"sessionValue"===s[s.length-1],content:(0,g.jsx)(Y,{type:"sessionValue",value:_,onChange:$,isEditable:"sessionValue"===M,placeholder:i.isSessionValueDeleted?"[Deleted]":e.sessionValuePlaceholder,preventEnter:e.disableMultilineValue||!1,currentWidth:G("sessionValue"),onFocus:()=>P("sessionValue"),readOnly:i.disableEdit||e.nonEditableSessionValue,shouldFocusOnMount:!0,onBlur:()=>P(null),editorType:O,maskState:p,enableVariableSuggestions:x})}),s.includes("options")&&(0,g.jsx)(w,{columnWidth:G("options"),isNonEditable:X("options"),isLastColumn:s&&"options"===s[s.length-1],content:(0,g.jsx)($e,{isRowFocused:K,tabIndex:-1,onChange:e=>$("options",e),options:k,value:D,isClearable:!1,isSearchable:!1,menuWidth:100})}),(0,g.jsx)(Le,{children:((null==s?void 0:s.includes("value"))||(null==s?void 0:s.includes("description"))||(null==s?void 0:s.includes("sessionValue")))&&!e.isRowSelected&&!e.value.disableEdit&&(0,g.jsxs)(g.Fragment,{children:[W===Z&&(0,g.jsx)(_e,{isVisible:I,maskState:p,onClick:()=>h(n)}),(0,g.jsxs)(Pe,{isHidden:K,isVisible:I,children:[!e.disableDelete&&(0,g.jsx)(S,{onClick:U}),!e.disableVariableRowDropdown&&d.includes("sessionValue")&&(0,g.jsx)(We,{onPersist:v,onReset:f,disableVariablePersistAction:e.disableVariablePersistAction||e.disableSecretVariablesSync&&W===Z,disablePersistActionTooltip:e.disablePersistActionTooltip,disableVariableResetAction:e.disableVariableResetAction||e.disableSecretVariablesSync&&W===Z,disableResetActionTooltip:e.disableResetActionTooltip})]})]})})]})]})}const Ye=(0,l.memo)(Xe,((e,n)=>{const{prevValue:i,prevCurrentWidth:l}=e,t=(0,r.Z)(e,Ze),{nextValue:o,nextCurrentWidth:a}=n,s=(0,r.Z)(n,He);return!!u()(i,o)&&(!!u()(t,s)&&!!k(l,a))}));var Ge=i(49437),Je=i(80047);const Qe=["values","disableSorting","onChange","onRemove","disableDelete","disableCreate","disableToggle","keyPlaceholder","valuePlaceholder","descriptionPlaceholder","disableVariableRowDropdown","currentWidth","maskStatesMap","toggleMaskValue","onPersist","onReset","onBlur","filteredIndices","searchValue","enableScroll","duplicateWarningsMap"],en=o().div.withConfig({displayName:"key-value-form-sortable__KeyValueFormSortableContainer",componentId:"sc-17kmkrd-0"})(["display:flex;flex:1;flex-direction:column;",";.key-value-form-editor-sortable__selectable{display:flex;flex-direction:column;}"],(({enableScroll:e})=>e&&"overflow: overlay;"));function nn(e){let{values:n,disableSorting:i,onChange:t,onRemove:o,disableDelete:a,disableCreate:s,disableToggle:d,keyPlaceholder:c,valuePlaceholder:u,descriptionPlaceholder:p,disableVariableRowDropdown:h,currentWidth:b,maskStatesMap:v,toggleMaskValue:f,onPersist:m,onReset:y,onBlur:x,filteredIndices:w,searchValue:C,enableScroll:k,duplicateWarningsMap:j}=e,V=(0,r.Z)(e,Qe);const S=(0,l.useCallback)(((e,n)=>{t&&t(e,n)}),[t]),T=(0,l.useCallback)((e=>{o&&o(e)}),[o]),E=C&&w?w.map((e=>n[e])):n;return(0,g.jsx)(en,{enableScroll:k,children:C&&0===E.length?(0,g.jsx)("div",{className:"key-value-form-editor-sortable",children:(0,g.jsx)(Ge.Z,{title:"No results found",children:(0,g.jsx)(Je.Z,{name:"illustration-search"})})}):E&&E.map(((e,l)=>{var t,o,r;const w=e.id===(null==n?void 0:n.length)-1;return(0,g.jsx)(Ye,Object.assign({index:null!=(t=e.id)?t:l,selectableKey:e.id,value:e,onChange:n=>S(e.id,n),onRemove:()=>T(e.id),onPersist:()=>{return n=e.id,void(m&&m(n));var n},onReset:()=>{return n=e.id,void(y&&y(n));var n},onBlur:(n,i)=>((e,n,i)=>{x&&x(e,n,i)})(e.id,n,i),disableSorting:i||w,disableToggle:d||w&&!s,disableDelete:a||w&&!s,disableVariableRowDropdown:h||w&&!s,keyPlaceholder:w&&c,valuePlaceholder:w&&u,descriptionPlaceholder:w&&p,hideVariableTypeDropdown:!s&&w,currentWidth:b,maskState:!(!s&&w)&&(v&&v[e.id]||{isMasked:e.type===Z}),isDuplicated:j&&j[e.id].isOverridden,toggleMaskValue:f},V),null!=(o=null==(r=e.id)?void 0:r.toString())?o:l)}))})}var ln=i(70355);function tn(e,n=100){return e/n*100}function on(e,n=2){return Math.round(e*Math.pow(10,n))/Math.pow(10,n)}const an=500,sn=o().div.withConfig({displayName:"resize-handle__StyledDiv",componentId:"sc-o8gbx1-0"})(["height:32px;width:16px;margin-left:-8px;background-color:transparent;position:absolute;left:","%;cursor:col-resize;z-index:1;"],(e=>e.left)),rn=e=>{const{showColumns:n,currentWidth:i,prevColumn:t,nextColumn:o,parentWidth:a=an,handleResize:s}=e,r=(0,l.useCallback)((e=>{const l=null==n?void 0:n.indexOf(e);if(-1===l)return 0;let t=0;for(let e=0;e<=l;e++)t+=i[e];return on(t)}),[n,i]),d=(0,l.useMemo)((()=>{const e=r(n[(null==n?void 0:n.indexOf(t))-1])+tn(100,a),i=r(o)-tn(100,a);return{min:on(e),max:on(i)}}),[t,o,n,a,r]),c=(0,l.useCallback)((e=>Number.isNaN(d.min)||Number.isNaN(d.max)?e:on(Math.min(Math.max(e,d.min),d.max))),[d]),u=(0,l.useCallback)(((e,l)=>{const r=c(tn(l.x,a));if(r==d.min||r==d.max)return;const u=[...i],p=i[n.indexOf(t)]+l.deltaX/a*100,h=i[n.indexOf(o)]-l.deltaX/a*100;u[null==n?void 0:n.indexOf(t)]=on(p,2),u[null==n?void 0:n.indexOf(o)]=on(h,2),null==s||s(u)}),[a,i,n,d]);return(0,g.jsx)(ln.DraggableCore,{onDrag:u,children:(0,g.jsx)(sn,{left:c(r(t))})})},dn=o().div.withConfig({displayName:"key-value-header__KeyValueFormHeader",componentId:"sc-4dw07d-0"})(["font-size:var(--text-size-m);font-family:var(--font-family-default);"]),cn=o().div.withConfig({displayName:"key-value-header__StyledHeaderActionsContainer",componentId:"sc-4dw07d-1"})(["border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);display:flex;align-items:center;height:32px;padding:0 var(--spacing-xs);"]),un=o().div.withConfig({displayName:"key-value-header__KeyValueFormHeaderRow",componentId:"sc-4dw07d-2"})(["display:flex;flex-direction:row;height:32px;position:relative;flex:1 1 auto;margin-bottom:var(--spacing-zero);border-bottom:var(--border-width-default) var(--border-style-solid) var(--border-color-default);&:hover,&.is-hovered{background-color:transparent;}&__is-highlighted{background-color:var(--background-color-info);animation:fadeOut 1.2s linear 1;.key-value-form-row__modification-options{background-color:var(--background-color-info);animation:fadeOut 1.2s linear 1;}}"]),pn=o().div.withConfig({displayName:"key-value-header__KeyValueHeaderActions",componentId:"sc-4dw07d-3"})(["position:relative;display:flex;border-top-width:0;width:44px;justify-content:flex-end;border-left:var(--border-width-default) var(--border-style-solid) var(--border-color-default);border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);background-color:",";"],(e=>e.nonEditableToggles?"var(--background-color-secondary);":"inherit")),hn=o().div.withConfig({displayName:"key-value-header__FeedbackState",componentId:"sc-4dw07d-4"})(["height:30px;width:0;position:absolute;background-color:var(--border-color-default);"]),bn=o().div.withConfig({displayName:"key-value-header__HeadersGroup",componentId:"sc-4dw07d-5"})(["flex:1;flex-direction:row;position:relative;min-width:0;display:flex;"]),gn=o().div.withConfig({displayName:"key-value-header__HeaderContent",componentId:"sc-4dw07d-6"})(["padding:var(--spacing-s);color:var(--content-color-secondary);font-size:var(--text-size-m);line-height:var(--line-height-m);font-weight:var(--text-weight-medium);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:default;user-select:none;"]),vn=o().div.withConfig({displayName:"key-value-header__HeaderColumn",componentId:"sc-4dw07d-7"})(["align-items:center;flex:",";overflow:hidden;display:flex;position:relative;box-sizing:border-box;border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);margin:var(--spacing-zero);background-color:",";"],(e=>e.isLastColumn?`0 1 ${e.columnWidth}%`:`0 0 ${e.columnWidth}%`),(e=>e.isNonEditable?"var(--background-color-secondary)":"inherit")),fn=new Map;fn.set("persistAll",{disabled:"You do not have permissions to perform this action.",default:"Persisting all values will replace all initial values with the current values of the variables."}),fn.set("resetAll",{default:"Resetting all values will replace all current values with the initial values of the variables."});const mn=(e,n,i)=>{let l;var t,o;return n&&(l=i||(null==(t=fn.get(e))?void 0:t.disabled)),l||(l=null==(o=fn.get(e))?void 0:o.default),l},yn=({allowedColumns:e,persistAll:n,disableVariablePersistAction:i,disablePersistActionTooltip:l,resetAll:t,disableVariableResetAction:o,disableResetActionTooltip:a})=>e.includes("sessionValue")?(0,g.jsx)(cn,{children:(0,g.jsxs)(De.Z,{closeOnSelect:!1,children:[(0,g.jsx)(Oe.Z,{"data-testid":"key-value-editor-more-actions-button",children:(0,g.jsx)(Re.Z,{size:"small",icon:(0,g.jsx)(Fe.Z,{size:"small"}),type:"tertiary",tooltip:"View more actions","data-testid":"more-options-button-column-header"})}),(0,g.jsxs)(Ae.Z,{children:[(0,g.jsx)(Ne.Z,{onClick:n,isDisabled:i,tooltip:mn("persistAll",i,l),children:"Persist all"}),(0,g.jsx)(Ne.Z,{onClick:t,isDisabled:o,tooltip:mn("resetAll",o,a),children:"Reset all"})]})]})}):null;function xn(e){const{showColumns:n,currentWidth:i,handleWidthChange:t,keyHeading:o,valueHeading:a,descriptionHeading:s,sessionHeading:r,typeHeading:d,optionsHeading:c,allowedColumns:u,persistAll:p,resetAll:h,disableVariablePersistAction:b,disablePersistActionTooltip:v,disableVariableResetAction:f,disableResetActionTooltip:m}=e,y=(0,l.useRef)(null),[x,w]=(0,l.useState)(null);(0,l.useEffect)((()=>{const e=new ResizeObserver((e=>{w(e[0].contentRect.width)})),n=y.current;return e.observe(n),()=>{e.unobserve(n)}}),[]);const k=(0,l.useCallback)((n=>e[`nonEditable${C(n)}s`]),[e]),j=(0,l.useCallback)((e=>Number(i[null==n?void 0:n.indexOf(e)])),[n,i]);return(0,g.jsx)(dn,{role:"rowgroup",children:(0,g.jsxs)(un,{role:"row",children:[(0,g.jsx)(pn,{children:(0,g.jsx)(hn,{})}),(0,g.jsxs)(bn,{ref:y,children:[(0,g.jsx)(vn,{type:"key",role:"columnheader",columnWidth:j("key"),isNonEditable:k("key"),isLastColumn:n&&"key"===n[n.length-1],children:(0,g.jsx)(gn,{children:o||"Key"})}),(null==n?void 0:n.includes("variableType"))&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(rn,{handleResize:t,showColumns:n,currentWidth:i,prevColumn:"key",nextColumn:"variableType",parentWidth:x}),(0,g.jsx)(vn,{type:"variableType",role:"columnheader",columnWidth:j("variableType"),isNonEditable:k("variableType"),isLastColumn:n&&"variableType"===n[n.length-1],children:(0,g.jsx)(gn,{children:d||"Type"})})]}),(null==n?void 0:n.includes("value"))&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(rn,{handleResize:t,showColumns:n,currentWidth:i,prevColumn:n.includes("variableType")?"variableType":"key",nextColumn:"value",parentWidth:x}),(0,g.jsx)(vn,{type:"value",role:"columnheader",columnWidth:j("value"),isNonEditable:k("value"),isLastColumn:n&&"value"===n[n.length-1],children:(0,g.jsx)(gn,{children:a||"Value"})})]}),(null==n?void 0:n.includes("description"))&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(rn,{handleResize:t,showColumns:n,currentWidth:i,prevColumn:"value",nextColumn:"description",parentWidth:x}),(0,g.jsx)(vn,{type:"description",role:"columnheader",columnWidth:j("description"),isNonEditable:k("description"),isLastColumn:n&&"description"===n[n.length-1],children:(0,g.jsx)(gn,{children:s||"Description"})})]}),(null==n?void 0:n.includes("sessionValue"))&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(rn,{handleResize:t,showColumns:n,currentWidth:i,prevColumn:"value",nextColumn:"sessionValue",parentWidth:x}),(0,g.jsx)(vn,{type:"sessionValue",role:"columnheader",columnWidth:j("sessionValue"),isNonEditable:k("sessionValue"),isLastColumn:n&&"sessionValue"===n[n.length-1],children:(0,g.jsx)(gn,{children:r||"Current value"})})]}),u.includes("sessionValue")&&(0,g.jsx)(yn,{allowedColumns:u,persistAll:p,resetAll:h,disablePersistActionTooltip:v,disableResetActionTooltip:m,disableVariablePersistAction:b,disableVariableResetAction:f}),(null==n?void 0:n.includes("options"))&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(rn,{handleResize:t,showColumns:n,currentWidth:i,prevColumn:"value",nextColumn:"options",parentWidth:x}),(0,g.jsx)(vn,{type:"options",role:"columnheader",columnWidth:j("options"),isNonEditable:k("options"),isLastColumn:n&&"options"===n[n.length-1],children:(0,g.jsx)(gn,{children:c||"Options"})})]})]})]})})}const wn=["defaultValue","entityType","values","onChange","showColumns","nonEditableKeys","nonEditableValues","nonEditableDescriptions","nonEditableToggles","nonEditableOptions","keyHeading","valueHeading","sessionHeading","optionsHeading","optionsTooltip","nonEditableVariableTypes","hideBulkOptions","maskStatesMap","toggleMaskValue","initialColumnWidths","disableVariablePersistAction","disableVariableResetAction","disableSecretVariablesSync","disablePersistActionTooltip","disableResetActionTooltip","onDeleteRow","disallowDuplicates"],Cn=o().div.withConfig({displayName:"key-value-form-editor__StyledKeyValueFormEditor",componentId:"sc-1xhynph-0"})(["display:flex;flex:1;flex-direction:column;border-top:thin solid var(--border-color-default);min-height:0;"]);function kn(e){let{defaultValue:n="",entityType:i,values:t,onChange:o,showColumns:a,nonEditableKeys:s,nonEditableValues:d,nonEditableDescriptions:c,nonEditableToggles:u,nonEditableOptions:p,keyHeading:h,valueHeading:b,sessionHeading:v,optionsHeading:f,optionsTooltip:m,nonEditableVariableTypes:y,hideBulkOptions:x,maskStatesMap:w,toggleMaskValue:C,initialColumnWidths:k,disableVariablePersistAction:j,disableVariableResetAction:V,disableSecretVariablesSync:S,disablePersistActionTooltip:T,disableResetActionTooltip:E,onDeleteRow:_,disallowDuplicates:D}=e,O=(0,r.Z)(e,wn);const R={showColumns:a,allowedColumns:O.allowedColumns,nonEditableKeys:s,nonEditableValues:d,nonEditableDescriptions:c,nonEditableToggles:u,nonEditableOptions:p,hideBulkOptions:x},A=(0,l.useRef)(o);A.current=o;const[N,F]=(0,l.useState)(function(e,n){let i;return n?i=n:(i=new Array(e.length).fill(Math.floor(100/e.length)),i[i.length-1]=i.at(-1)+(100-i.reduce(((e,n)=>e+n)))),i}(a,k)),W=(0,l.useCallback)(((e,l={})=>{let t="text";"environment"!==i&&"globals"!==i||(t="default"),"collection"===i&&(t="string");const o={key:l.key||n,value:l.value||n,description:l.description||n,type:l.type||t,id:e};return O.allowedColumns.includes("sessionValue")&&(o.sessionValue=l.sessionValue||null),O.disableToggle||(o.enabled=!0),o}),[n,O.disableToggle,i,O.allowedColumns]),M=(0,l.useCallback)((()=>{if(t.length>0){var e=null==t?void 0:t.reduce((function(e,n){return e.id>=n.id?e:n}),{});return n=e,[Object,Array].includes((n||{}).constructor)&&0===Object.entries(n||{}).length?0:e.id+1}var n;return 0}),[t]),P=(0,l.useCallback)(((e,n)=>{const i=[...t],l=i.length===e?[...i,W(M(),n)]:i.map((i=>i.id===e?Object.assign({},i,n):Object.assign({},i)));null==A.current||A.current(l)}),[t,W,M]),I=(0,l.useCallback)((e=>{const n=[...t],i=null==n?void 0:n.filter(((n={})=>n.id!==e));_&&_(e),null==A.current||A.current(i)}),[t,_]),z=(0,g.jsx)(xn,Object.assign({},R,{keyHeading:h||"Key",valueHeading:b||"Value",sessionHeading:v||"Current value",optionsHeading:f||"Options",optionsTooltip:m,nonEditableVariableTypes:y,handleWidthChange:F,currentWidth:N,persistAll:()=>{if(j)return;let e=!1;const n=t.reduce(((n,i)=>{const l=i.enabled?i.sessionValue:i.value;return i.isSessionValueDeleted?(e=!0,n):(!e&&(e=!(S&&i.type===Z)),S&&i.type===Z?n.push(i):n.push(Object.assign({},i,{value:l})),n)}),[]);e&&(null==A.current||A.current(n))},resetAll:()=>{if(V)return;let e=!1;const n=t.map((n=>{const i=n.enabled?n.value:n.sessionValue;return S&&n.type===Z?n:(e=!0,Object.assign({},n,{sessionValue:i,isSessionValueDeleted:!1}))}));e&&(null==A.current||A.current(n))},disableVariablePersistAction:j,disableVariableResetAction:V,disablePersistActionTooltip:T,disableResetActionTooltip:E})),H=(0,l.useMemo)((()=>O.disableCreate?t:[...t,W(M())]),[t,O.disableCreate,W,M]),B=(0,l.useMemo)((()=>D?H.map(((e,n)=>{if(e.enabled&&""!==e.key)for(let i=n+1;i<H.length;i++){const n=H[i];if(e.key===n.key&&n.enabled&&""!==n.key)return Object.assign({},e,{isOverridden:!0})}return Object.assign({},e,{isOverridden:!1})})):null),[H,D]);return(0,g.jsxs)(Cn,{children:[t.length>0||!O.disableCreate?z:null,(0,g.jsx)(nn,Object.assign({},R,O,{nonEditableVariableTypes:y,values:H,onChange:P,onRemove:I,currentWidth:N,maskStatesMap:w,toggleMaskValue:C,onPersist:e=>{if(j)return;let n=!1;const i=t.reduce(((i,l)=>{if(l.id===e){if(l.isSessionValueDeleted)return n=!0,i;S&&l.type===Z?i.push(l):(n=!0,i.push(Object.assign({},l,{value:l.sessionValue})))}else i.push(l);return i}),[]);n&&(null==A.current||A.current(i))},onReset:e=>{if(V)return;let n=!1;const i=t.map((i=>i.id!==e||S&&i.type===Z?i:(n=!0,Object.assign({},i,{sessionValue:i.value,isSessionValueDeleted:!1}))));n&&(null==A.current||A.current(i))},onBlur:(e,n,i)=>{const l=t.findIndex((n=>n.id===e)),o=-1!==l&&t[l].sessionValue;let a;"value"===n&&-1!==l&&null===o&&i.value&&(a=[...t],a[l]=Object.assign({},i,{sessionValue:i.value}),null==A.current||A.current(a))},disableVariablePersistAction:j,disableVariableResetAction:V,disableSecretVariablesSync:S,disablePersistActionTooltip:T,disableResetActionTooltip:E,duplicateWarningsMap:B}))]})}var jn=i(68206);const Vn=T(((e,...n)=>e(...n)),100),Sn=({onSearchValueChange:e})=>{const[n,i]=(0,l.useState)("");return(0,g.jsx)("div",{className:"search-variable",children:(0,g.jsx)(jn.Z,{placeholder:"Filter variables",value:n,type:"search",onChange:n=>{i(n.target.value),Vn(e,n.target.value)},onClear:()=>{i(""),e("")},prefix:!0,name:"filter-values"})})};function Tn(e,n){try{const i=(0,q.castNonStringTypesToString)(e),l=(0,q.castNonStringTypesToString)(n),t=i.toLowerCase(),o=l.toLowerCase();return t.indexOf(o)}catch(i){return console.error("PatterSearch~caseInsensitiveIndexof: Failed with error",i,e,n),-1}}const En=o().div.withConfig({displayName:"key-value-editor__KeyValueEditorContainer",componentId:"sc-4h8dgj-0"})(["padding-bottom:var(--spacing-s);display:flex;flex-direction:column;box-sizing:border-box;",";&.is-filterable{display:flex;flex-direction:column;}.search-variable{width:240px;padding-top:var(--spacing-xs);padding-bottom:var(--spacing-s);}"],(({enableScroll:e})=>e&&"height: 100%;")),_n=(e,n)=>!n||!(!e.key||-1===Tn(e.key,n))||"secret"!==e.type&&(!(!e.value||-1===Tn(e.value,n))||!(!e.sessionValue||-1===Tn(e.sessionValue,n))||void 0),Dn=(e,n)=>{if(!n)return null;const i=[];for(const[l,t]of e.entries())_n(t,n)&&i.push(l);return i},On=(0,s.observer)((function(e){const{values:n,onChange:i,tableName:t,disallowDuplicates:o,allowedColumns:s,showColumns:r,onColumnToggle:d,keyPlaceholder:c,valuePlaceholder:u,maskStatesMap:p,toggleMaskValue:h,initialColumnWidths:b,enableFiltering:v=!1,enableScroll:f,isDirty:m=!1}=e,[y,x]=(0,l.useState)([]),[w,C]=(0,l.useState)(""),[k,j]=(0,l.useState)(null),V=(0,l.useRef)(m),S=(0,l.useCallback)((e=>{if(0===y.length)return!0;e.preventDefault();const l=null==n?void 0:n.filter(((e,n)=>!(null!=y&&y.includes(n))));y.sort(),0!==y[0]&&(y.length,n.length),x([]),i(l)}),[n,i,y]),T=(0,l.useCallback)((()=>{y.length>0&&x([])}),[y]),E=(0,l.useMemo)((()=>{let e=0;return(0,a.computed)((()=>null==n?void 0:n.map((n=>Object.assign({},n,{id:e++})))))}),[n]).get();return(0,l.useEffect)((()=>{const e=Dn(E,w);j(e)}),[w]),(0,l.useEffect)((()=>{if(V.current&&!m){const e=Dn(E,w);j(e)}V.current=m}),[m]),(0,g.jsxs)(En,{role:"table","aria-label":t,enableScroll:f,children:[v&&(0,g.jsx)(Sn,{onSearchValueChange:C}),(0,g.jsx)(kn,Object.assign({},e,{disallowDuplicates:o,onChange:i,values:E,selectedRows:y,deleteSelectedRows:S,onBeforeInput:T,allowedColumns:s,showColumns:r,onColumnToggle:d,keyPlaceholder:void 0===c?"Key":c,valuePlaceholder:void 0===u?"Value":u,descriptionPlaceholder:"Description",maskStatesMap:p,toggleMaskValue:h,initialColumnWidths:b,filteredIndices:k,searchValue:w,onDeleteRow:e=>{if(!w)return;const n=((e,n)=>{const i=[],l=new Set(n);let t=0;for(const n of e)l.has(n)?t++:i.push(n-t);return i})(k,[e]);j(n)}})),(0,g.jsx)(Ie.Modals.Ui.ModalDialog,{uid:"kv-editor-variable-type-change-confirmation"})]})})),Rn=e=>(0,g.jsx)(On,Object.assign({},e))}}]);
//# sourceMappingURL=1134.5b3c2e0fb51e88a5.js.map